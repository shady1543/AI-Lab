# 使用卷积神经网络实现中药图片分类

## 文件结构

* `CNN.ipynb`：代码。

  **准确率: 92.8% & 93.2% (Train / Test)**

* `Task.pdf`: 任务描述。

* `Tutor.pptx`: 实验课件。

* `data/`：所需要的数据。

**注意：想要复现出较高准确率，使用NVIDIA 3050 Laptop显卡大概需要训练一小时。**

> 要是你不想等那么久，或许有能让网络收敛更快的方法（BN）和参数（BatchSize、LearningRate）...

## 算法原理

### 卷积神经网络 (CNN)

卷积神经网络（Convolutional Neural Network, CNN）是深度学习中最基础的模型之一，广泛应用于图像处理和图像分类任务中。它通过模拟人类视觉系统的处理方式，能有效地识别图像中的局部模式和特征。

### 结构组成

一个典型的 CNN 主要包含四种类型的层：卷积层、激活函数、池化层和全连接层。

1. **卷积层**：卷积层通过卷积操作提取输入图像的特征。给定输入图像 $I$ 和卷积核 $K$，卷积操作定义为：

$$
S(i, j) = (I \ast K)(i, j) = \sum_m \sum_n I(m, n) K(i-m, j-n)
$$

   其中， $S(i, j)$ 是卷积输出在位置 $(i, j)$ 的值， $I(m, n)$ 是输入图像在位置 $(m, n)$ 的像素值， $K$ 是卷积核。

2. **激活函数**：激活函数应用于卷积层的输出，以引入非线性，使网络能够学习更复杂的模式。常用的激活函数包括ReLU函数，定义为：

$$
\text{ReLu}(x) = \max(0, x)
$$

   ReLU函数有助于加快网络的收敛速度，同时减少梯度消失问题。

3. **池化层**：池化层用于减少卷积层输出的空间尺寸，从而降低计算复杂度和过拟合的风险。池化操作通常包括最大池化和平均池化，其中最大池化定义为：

$$
P(i, j) = \max_{(m, n) \in W} I(m, n)
$$

   其中 $W$ 是在输入 $I$ 上以 $(i, j)$ 为中心的窗口。

4. **全连接层**：全连接层位于网络的末端，其将前一层的所有输出连接到每个神经元上。这一层的目的是将学习到的抽象高级特征映射到最终的输出类别上，如在分类任务中映射到具体的类标签。

### 前向传播

在CNN中，数据通过网络层进行前向传播，从输入层到输出层。每一层的输出作为下一层的输入，最终结果通过softmax层输出，这一层将连续值转换为概率分布。

Softmax层的输出定义为：

$$
\text{softmax}(z_i) = \frac{e^{z_i}}{\sum_k e^{z_k}}
$$

其中，  $z_i$ 是最后一个全连接层的输出。

### 训练策略

在训练过程中，CNN通过最小化损失函数来调整其参数，常用的损失函数是交叉熵损失函数，适用于多分类问题。交叉熵损失定义为：

$$
L = -\sum_{c=1}^{M} y_{o,c} \log(p_{o,c})
$$

其中， $M$ 是类别的数量， $y_{o,c}$ 是给定类别 $c$ 的实际标签， $p_{o,c}$ 是预测概率。